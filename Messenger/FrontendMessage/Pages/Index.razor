@page "/"
@inject HttpClient Http
<PageTitle>Chat</PageTitle>

<MudList T="Message">
	@foreach (var message in Messages)
	{
		<MudListItem>@message.dateTime.ToString("HH:mm") @message.text</MudListItem>
	}
</MudList>

<MudTextField @bind-Value="NewMessage" Label="Введите сообщение" />
<MudButton OnClick="SendMessage" Type="button">Send</MudButton>

@code {
	private List<Message> Messages = new();
	private string NewMessage = string.Empty;

	protected override async Task OnInitializedAsync()
	{
		Messages = await Http.GetFromJsonAsync<List<Message>>("api/Messages");
	}

	private async Task SendMessage()
	{
		if (!string.IsNullOrWhiteSpace(NewMessage))
		{
			await Http.PostAsJsonAsync("api/Messages", NewMessage);
			NewMessage = string.Empty;

			Messages = await Http.GetFromJsonAsync<List<Message>>("api/Messages");
		}
	}

	public class Message
	{
		public int id { get; set; }
		public string text { get; set; }
		public DateTime dateTime { get; set; }
	}
}


<style>
    .chat-container {
        max-width: 500px;
        margin: auto;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .chat-box {
        height: 300px;
        overflow-y: auto;
        border: 1px solid #ccc;
        border-radius: 10px;
        padding: 10px;
        background: #f9f9f9;
    }

    .chat-messages {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .chat-message {
        padding: 5px;
        background: #e3f2fd;
        border-radius: 5px;
    }

    .chat-input-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .chat-input {
        display: flex;
        gap: 10px;
    }

    .chat-textfield {
        flex-grow: 1;
    }
</style>